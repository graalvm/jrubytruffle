This directory contains [Dockerfiles](https://docs.docker.com/engine/reference/builder/) for building a few different OCI images (a.k.a. "Docker images") for TruffleRuby.


## Publishing

These images are built and published to this repository's package registry by the Github Actions CI pipelines defined at:

- .github/workflows/docker-nightly.yml
- .github/workflows/docker-stable.yml

Note that the "stable" images required a build argument to specify `TRUFFLERUBY_VERSION` which should be a version string like "21.1.0".


## Base Images

There are two base images being used:

- Debian Buster ([`buildpack-deps:buster`](https://hub.docker.com/_/buildpack-deps)) (~400MB compressed)
- Debian Buster "Slim" ([`debian:buster-slim`](https://hub.docker.com/_/debian)) (~170MB compressed)


### Y U NO Alpine?

As of 2020-10-01, the standalone TruffleRuby image isn't compatible with `musl` (meaning it isn't compatible with Alpine). You can read more about that in https://github.com/oracle/truffleruby/issues/1449.


### Other Base Images

The Dockerfiles are generated by `tool/dockerfiles/generate` which is easily extensible to other base images in the future. Submit a PR!


## Tags

The tags "nightly" and "nightly-slim" are generated daily, and are based on "buster" and "buster-slim", respectively.

Stable versions are available as "stable", "latest", or as the version number (e.g., "21.1.0"), and are available in "-slim" variants as well.


## Compatibility

These images should behave like the official CRuby and JRuby container images, especially when it comes to `gem install` and `bundle install` behavior. For reference and comparison:

- CRuby: [docker hub](https://hub.docker.com/_/ruby), [dockerfiles](https://github.com/docker-library/ruby/)
- JRuby: [docker hub](https://hub.docker.com/_/jruby), [dockerfiles](https://github.com/cpuguy83/docker-jruby/)
